%% Created by Maple 18.02, Mac OS X
%% Source Worksheet: Euler_ball_drop.mw
%% Generated: Sat Aug 19 19:21:13 JST 2017
\documentclass{article}
\usepackage{maplestd2e}
\def\emptyline{\vspace{12pt}}
\begin{document}
\pagestyle{empty}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Error}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Normal}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Hyperlink}
\section{\textbf{Verlet法}}
\section{\textbf{Euler\_ball\_drop}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler := proc (x_i, v_i)
  local v_ip1, x_ip1;
  global g, dt;
  v_ip1 := v_i - g * dt;
  x_ip1 := x_i + v_i * dt;
  return x_ip1, v_ip1;
end;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Euler := proc (x_i, v_i) local v_ip1, x_ip1; global g, dt; v_ip1 := v_i-g*dt; x_ip1 := x_i+v_i*dt; return x_ip1, v_ip1 end proc}{\[\displaystyle {\it Euler}\, := \,\textbf{proc} (x_iv_i) \\
\textbf{local} \,v_ip1,\,x_ip1; \\
\textbf{global} \,g,\,dt; \\
\mapleIndent{1} v_ip1\,:=\,v_i-g \ast dt;\\
\mapleIndent{1} x_ip1\,:=\,x_i + v_i \ast dt;\\
\mapleIndent{1} \textbf{return}\,x_ip1,\,v_ip1\\
\textbf{end\ proc};\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1;g:=0.1; 
vv:=[0];
xx:=[10]; 
for i from 2 to 200 do

  x, v := Euler(xx[i-1],vv[i-1]);
  xx :=[op(xx),x]; 
  vv :=[op(vv),v]; 
end do:

with(plots):
listplot(xx);
listplot(vv);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt := .1}{\[\displaystyle {\it dt}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{g := .1}{\[\displaystyle g\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{vv := [0]}{\[\displaystyle {\it vv}\, := \,[0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{xx := [10]}{\[\displaystyle {\it xx}\, := \,[10]\]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d1.eps}
\mapleresult
\mapleplot{Euler_ball_dropplot2d2.eps}
\end{maplegroup}
\section{\textbf{Euler\_ball\_drop\_with\_air\_resistance}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler2 := proc (x_i, v_i)
  local v_ip1, x_ip1;
  global g, dt;
  v_ip1 := v_i + (-cc * v_i- g) * dt;
  x_ip1 := x_i + v_i * dt;
  return x_ip1, v_ip1;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1: g:=0.1: cc:=1:
vv:=[0]: xx:=[10]: 
for i from 2 to 100 do
  x, v := Euler2(xx[i-1],vv[i-1]);
  xx :=[op(xx),x]; 
  vv :=[op(vv),v]; 
end do:

with(plots):
listplot(xx);
listplot(vv);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{Euler_ball_dropplot2d3.eps}
\mapleresult
\mapleplot{Euler_ball_dropplot2d4.eps}
\end{maplegroup}
\section{\textbf{バネの振動(Euler)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler2 := proc (x_i, v_i)
  local v_ip1, x_ip1;
  global k, cc, dx;
  v_ip1 := v_i + (- k * x_i - v_i * cc) * dt;
  x_ip1 := x_i + v_i * dt;
  return x_ip1, v_ip1;
end;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Euler2 := proc (x_i, v_i) local v_ip1, x_ip1; global k, cc, dx; v_ip1 := v_i+(-k*x_i-v_i*cc)*dt; x_ip1 := x_i+v_i*dt; return x_ip1, v_ip1 end proc}{\[\displaystyle {\it Euler2}\, := \,\textbf{proc} (x_iv_i) \\
\textbf{local} \,v_ip1,\,x_ip1; \\
\textbf{global} \,k,\,cc,\,dx; \\
\mapleIndent{1} v_ip1\,:=\,v_i + (-k \ast x_i-v_i \ast cc) \ast dt;\\
\mapleIndent{1} x_ip1\,:=\,x_i + v_i \ast dt;\\
\mapleIndent{1} \textbf{return}\,x_ip1,\,v_ip1\\
\textbf{end\ proc};\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1;k:=0.01;cc:=0.01;
vv:=[0.01];
xx:=[0]; 
for i from 2 to 4000 do
  x, y := Euler2(xx[i-1],vv[i-1]);
  xx :=[op(xx),x]; 
  vv :=[op(vv),y]; 
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt := .1}{\[\displaystyle {\it dt}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{k := 0.1e-1}{\[\displaystyle k\, := \, 0.01\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{cc := 0.1e-1}{\[\displaystyle {\it cc}\, := \, 0.01\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{vv := [0.1e-1]}{\[\displaystyle {\it vv}\, := \,[ 0.01]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{xx := [0]}{\[\displaystyle {\it xx}\, := \,[0]\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):
listplot(xx);listplot(vv);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{Euler_ball_dropplot2d5.eps}
\mapleresult
\mapleplot{Euler_ball_dropplot2d6.eps}
\end{maplegroup}
\section{\textbf{バネの振動(Runge-Kutta)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{ff := (t,x,v)-> v;
gg := (t,x,v)-> -k*x;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{ff := proc (t, x, v) options operator, arrow; v end proc}{\[\displaystyle {\it ff}\, := \,( {t,x,v} )\mapsto v\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{gg := proc (t, x, v) options operator, arrow; -k*x end proc}{\[\displaystyle {\it gg}\, := \,( {t,x,v} )\mapsto - 0.01\,x\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{RungeKutta2 := proc(x_i,y_i,z_i)
local h,k1,l1,k2,l2,k3,l3,k4,l4,kk,ll;
global dx;
h := dx;
k1:= h * ff(x_i, y_i, z_i);
l1:= h * gg(x_i, y_i, z_i);
k2:= h*ff(x_i+h/2, y_i+k1/2, z_i+l1/2);
l2:= h*gg(x_i+h/2, y_i+k1/2, z_i+l1/2);
k3:= h*ff(x_i+h/2, y_i+k2/2, z_i+l2/2);
l3:= h*gg(x_i+h/2, y_i+k2/2, z_i+l2/2);
k4:= h*ff(x_i+h, y_i+k3, z_i+l3);
l4:= h*gg(x_i+h, y_i+k3, z_i+l3);
kk := 1/6*(k1+2*k2+2*k3+k4);

ll := 1/6*(l1+2*l2+2*l3+l4);

return kk,ll;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler2 := proc (x_i, v_i)
  local v_ip1, x_ip1, kk, ll;
  kk,ll := RungeKutta2(0,x_i,v_i);
  x_ip1:= x_i+kk;
  v_ip1:= v_i+ll;
  return x_ip1, v_ip1;
end;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Euler2 := proc (x_i, v_i) local v_ip1, x_ip1, kk, ll; kk, ll := RungeKutta2(0, x_i, v_i); x_ip1 := x_i+kk; v_ip1 := v_i+ll; return x_ip1, v_ip1 end proc}{\[\displaystyle {\it Euler2}\, := \,\textbf{proc} (x_iv_i) \\
\textbf{local} \,v_ip1,\,x_ip1,\,kk,\,ll; \\
\mapleIndent{1} kk,\,ll\,:=\,\mathit{RungeKutta2} (0,\,x_i,\,v_i);\\
\mapleIndent{1} x_ip1\,:=\,x_i + kk;\\
\mapleIndent{1} v_ip1\,:=\,v_i + ll;\\
\mapleIndent{1} \textbf{return}\,x_ip1,\,v_ip1\\
\textbf{end\ proc};\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dx:=0.1;k:=0.01;cc:=0.0;
vv:=[0.01];
xx:=[0]; 
for i from 2 to 4000 do
  x, y := Euler2(xx[i-1],vv[i-1]);
  xx :=[op(xx),x]; 
  vv :=[op(vv),y]; 
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dx := .1}{\[\displaystyle {\it dx}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{k := 0.1e-1}{\[\displaystyle k\, := \, 0.01\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{cc := 0.}{\[\displaystyle {\it cc}\, := \, 0.0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{vv := [0.1e-1]}{\[\displaystyle {\it vv}\, := \,[ 0.01]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{xx := [0]}{\[\displaystyle {\it xx}\, := \,[0]\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):
listplot(xx);listplot(vv);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{Euler_ball_dropplot2d7.eps}
\mapleresult
\mapleplot{Euler_ball_dropplot2d8.eps}
\end{maplegroup}
\section{\textbf{LCR回路}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler2 := proc (q_i, i_i)
  local q_ip1, i_ip1;
  global v_i, dx, RR, qc;
  i_ip1 := v_i * dx + i_i - RR * i_i - q_i * qc;
  q_ip1 := q_i + q_i * dx;
  return q_ip1, i_ip1;
end;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Euler2 := proc (q_i, i_i) local q_ip1, i_ip1; global v_i, dx, RR, qc; i_ip1 := v_i*dx+i_i-RR*i_i-q_i*qc; q_ip1 := q_i+q_i*dx; return q_ip1, i_ip1 end proc}{\[\displaystyle {\it Euler2}\, := \,\textbf{proc} (q_ii_i) \\
\textbf{local} \,q_ip1,\,i_ip1; \\
\textbf{global} \,v_i,\,dx,\,RR,\,qc; \\
\mapleIndent{1} i_ip1\,:=\,v_i \ast dx + i_i-RR \ast i_i-q_i \ast qc;\\
\mapleIndent{1} q_ip1\,:=\,q_i + q_i \ast dx;\\
\mapleIndent{1} \textbf{return}\,q_ip1,\,i_ip1\\
\textbf{end\ proc};\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dx:=0.01;RR:=0.1;qc:=0.1;

v_i:=1;
ii:=[0];
qq:=[2]; 
for i from 2 to 100 do
  q, i2 := Euler2(qq[i-1],ii[i-1]);
  qq :=[op(qq),q]; 
  ii :=[op(ii),i2]; 
end do:
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dx := 0.1e-1}{\[\displaystyle {\it dx}\, := \, 0.01\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{RR := .1}{\[\displaystyle {\it RR}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{qc := .1}{\[\displaystyle {\it qc}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{v_i := 1}{\[\displaystyle {\it v\_i}\, := \,1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{ii := [0]}{\[\displaystyle {\it ii}\, := \,[0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{qq := [2]}{\[\displaystyle {\it qq}\, := \,[2]\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{with(plots):
listplot(qq);listplot(ii);
}{}
\end{mapleinput}
\mapleresult
\mapleplot{Euler_ball_dropplot2d9.eps}
\mapleresult
\mapleplot{Euler_ball_dropplot2d10.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{}{}
\end{mapleinput}
\end{maplegroup}
\end{document}
