%% Created by Maple 18.02, Mac OS X
%% Source Worksheet: Euler_ball_drop.mw
%% Generated: Fri Dec 01 13:57:32 JST 2017
\documentclass{article}
\usepackage{maplestd2e}
\def\emptyline{\vspace{12pt}}
\begin{document}
\pagestyle{empty}
\DefineParaStyle{Maple Bullet Item}
\DefineParaStyle{Maple Heading 1}
\DefineParaStyle{Maple Warning}
\DefineParaStyle{Maple Heading 4}
\DefineParaStyle{Maple Heading 2}
\DefineParaStyle{Maple Heading 3}
\DefineParaStyle{Maple Dash Item}
\DefineParaStyle{Maple Error}
\DefineParaStyle{Maple Title}
\DefineParaStyle{Maple Text Output}
\DefineParaStyle{Maple Normal}
\DefineCharStyle{Maple 2D Output}
\DefineCharStyle{Maple 2D Input}
\DefineCharStyle{Maple Maple Input}
\DefineCharStyle{Maple 2D Math}
\DefineCharStyle{Maple Hyperlink}
\section{\textbf{Verlet法}}
\section{\textbf{Euler\_ball\_drop}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler := proc (x0, v0)
  local v1, x1;
  global g, dt;
  v1 := v0 - g * dt;
  x1 := x0 + v0 * dt;
  return x1, v1;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1;g:=9.8; 
tt,vv,xx:=[0.0],[0],[10.0];
for i from 2 to 50 do
  x, v := Euler(xx[i-1],vv[i-1]);

  tt :=[op(tt),tt[-1]+dt];
  xx :=[op(xx),x]; 
  vv :=[op(vv),v]; 
end do:

with(plots):
lx:=listplot([tt,xx],color='blue');
lv:=listplot([tt,vv],color='red');
display(lx,lv);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt := .1}{\[\displaystyle {\it dt}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{g := 9.8}{\[\displaystyle g\, := \, 9.8\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{tt, vv, xx := [0.], [0], [10.0]}{\[\displaystyle {\it tt},\,{\it vv},\,{\it xx}\, := \,[ 0.0],\,[0],\,[ 10.0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lx := PLOT(`...`)}{\[\displaystyle {\it lx}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lv := PLOT(`...`)}{\[\displaystyle {\it lv}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d1.eps}
\end{maplegroup}
\section{\textbf{Euler\_ball\_drop\_with\_air\_resistance}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler2 := proc (x0, v0)
  local v1, x1;
  global g, dt;
  v1 := v0 + (-cc * v0- g) * dt;
  x1 := x0 + v0 * dt;
  return x1, v1;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1: g:=9.8: cc:=1:
tt,vv,xx:=[0.0],[0],[10.0];
for i from 2 to 50 do
  x, v := Euler2(xx[i-1],vv[i-1]);
  tt :=[op(tt),tt[-1]+dt];
  xx :=[op(xx),x]; 
  vv :=[op(vv),v]; 
end do:

with(plots):
lx:=listplot([tt,xx],color='blue');
lv:=listplot([tt,vv],color='red');
display(lx,lv);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{tt, vv, xx := [0.], [0], [10.0]}{\[\displaystyle {\it tt},\,{\it vv},\,{\it xx}\, := \,[ 0.0],\,[0],\,[ 10.0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lx := PLOT(`...`)}{\[\displaystyle {\it lx}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lv := PLOT(`...`)}{\[\displaystyle {\it lv}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d2.eps}
\end{maplegroup}
\section{\textbf{バネの振動(Euler)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler3 := proc (x0, v0)
  local v1, x1;
  global k, dx;
  v1 := v0 + (- k * x0 ) * dt;
  x1 := x0 + v0 * dt;
  return x1, v1;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1;k:=0.01;
tt,vv,xx:=[0.0],[0],[10.0];
for i from 2 to 5000 do
  x, v := Euler3(xx[i-1],vv[i-1]);
  tt :=[op(tt),tt[-1]+dt];
  xx :=[op(xx),x]; 
  vv :=[op(vv),v]; 
end do:

with(plots):
lx:=listplot([tt,xx],color='blue');
lv:=listplot([tt,vv],color='red');
display(lx,lv);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt := .1}{\[\displaystyle {\it dt}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{k := 0.1e-1}{\[\displaystyle k\, := \, 0.01\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{tt, vv, xx := [0.], [0], [10.0]}{\[\displaystyle {\it tt},\,{\it vv},\,{\it xx}\, := \,[ 0.0],\,[0],\,[ 10.0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lx := PLOT(`...`)}{\[\displaystyle {\it lx}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lv := PLOT(`...`)}{\[\displaystyle {\it lv}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d3.eps}
\end{maplegroup}
\section{\textbf{バネの振動(Runge-Kutta)}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{restart;
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{ff := (t,x,v)-> v;
gg := (t,x,v)-> -k*x;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{ff := proc (t, x, v) options operator, arrow; v end proc}{\[\displaystyle {\it ff}\, := \,( {t,x,v} )\mapsto v\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{gg := proc (t, x, v) options operator, arrow; -k*x end proc}{\[\displaystyle {\it gg}\, := \,( {t,x,v} )\mapsto - 0.01\,x\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{RungeKutta4 := proc(x_i,y_i,z_i,h)
local k1,l1,k2,l2,k3,l3,k4,l4,kk,ll;

k1:= h * ff(x_i, y_i, z_i);
l1:= h * gg(x_i, y_i, z_i);
k2:= h*ff(x_i+h/2, y_i+k1/2, z_i+l1/2);
l2:= h*gg(x_i+h/2, y_i+k1/2, z_i+l1/2);
k3:= h*ff(x_i+h/2, y_i+k2/2, z_i+l2/2);
l3:= h*gg(x_i+h/2, y_i+k2/2, z_i+l2/2);
k4:= h*ff(x_i+h, y_i+k3, z_i+l3);
l4:= h*gg(x_i+h, y_i+k3, z_i+l3);
kk := 1/6*(k1+2*k2+2*k3+k4);
ll := 1/6*(l1+2*l2+2*l3+l4);
return kk,ll;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{ode := proc (x0, v0)
  local v1, x1, kk, ll;
  kk,ll := RungeKutta4(0,x0,v0,dt);
  x1:= x0+kk;
  v1:= v0+ll;
  return x1, v1;
end:
}{}
\end{mapleinput}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt:=0.1;k:=0.01;
tt,vv,xx:=[0.0],[0],[10.0];
for i from 2 to 5000 do
  x, v := ode(xx[i-1],vv[i-1]);
  tt :=[op(tt),tt[-1]+dt];
  xx :=[op(xx),x]; 
  vv :=[op(vv),v]; 
end do:

with(plots):
lx:=listplot([tt,xx],color='blue');
lv:=listplot([tt,vv],color='red');
display(lx,lv);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt := .1}{\[\displaystyle {\it dt}\, := \, 0.1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{k := 0.1e-1}{\[\displaystyle k\, := \, 0.01\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{tt, vv, xx := [0.], [0], [10.0]}{\[\displaystyle {\it tt},\,{\it vv},\,{\it xx}\, := \,[ 0.0],\,[0],\,[ 10.0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lx := PLOT(`...`)}{\[\displaystyle {\it lx}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lv := PLOT(`...`)}{\[\displaystyle {\it lv}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d4.eps}
\end{maplegroup}
\section{\textbf{LCR回路}}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{Euler2 := proc (q0, i0)
  local q1, i1;
  global r,qc,v,dt;
  i1 := i0 + (v - r*i0 -qc*q0) * dt;
  q1 := q0 + i0 * dt;
  return q1, i1;
end;
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{Euler2 := proc (q0, i0) local q1, i1; global r, qc, v, dt; i1 := i0+(v-r*i0-qc*q0)*dt; q1 := q0+i0*dt; return q1, i1 end proc}{\[\displaystyle {\it Euler2}\, := \,\textbf{proc} (q0i0) \\
\textbf{local} \,q1,\,i1; \\
\textbf{global} \,r,\,qc,\,v,\,dt; \\
\mapleIndent{1} i1\,:=\,i0 + (v-r \ast i0-qc \ast q0) \ast dt;\\
\mapleIndent{1} q1\,:=\,q0 + i0 \ast dt;\\
\mapleIndent{1} \textbf{return}\,q1,\,i1\\
\textbf{end\ proc};\]}
\end{maplelatex}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt,r, qc,v := 0.01, 0.5 ,1, 1;
tt,ii,qq:=[0],[0.0],[0];
for i from 2 to 2000 do
  q, i2 := Euler2(qq[i-1],ii[i-1]);
  tt :=[op(tt),tt[-1]+dt];
  qq :=[op(qq),q]; 
  ii :=[op(ii),i2]; 
end do:


with(plots):
lx:=listplot([tt,qq],color='blue');
lv:=listplot([tt,ii],color='red');
display(lx,lv);
}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt, r, qc, v := 0.1e-1, .5, 1, 1}{\[\displaystyle {\it dt},\,r,\,{\it qc},\,v\, := \, 0.01,\, 0.5,\,1,\,1\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{tt, ii, qq := [0], [0.], [0]}{\[\displaystyle {\it tt},\,{\it ii},\,{\it qq}\, := \,[0],\,[ 0.0],\,[0]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lx := PLOT(`...`)}{\[\displaystyle {\it lx}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lv := PLOT(`...`)}{\[\displaystyle {\it lv}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d5.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{dt,r, qc,v := 0.01, 0.5 ,1, 0;
tt,ii,qq:=[0],[0.0],[1];
for i from 2 to 2000 do
  q, i2 := Euler2(qq[i-1],ii[i-1]);
  tt :=[op(tt),tt[-1]+dt];
  qq :=[op(qq),q]; 
  ii :=[op(ii),i2]; 
end do:

with(plots):
lx:=listplot([tt,qq],color='blue');
lv:=listplot([tt,ii],color='red');
display(lx,lv);}{}
\end{mapleinput}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{dt, r, qc, v := 0.1e-1, .5, 1, 0}{\[\displaystyle {\it dt},\,r,\,{\it qc},\,v\, := \, 0.01,\, 0.5,\,1,\,0\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{tt, ii, qq := [0], [0.], [1]}{\[\displaystyle {\it tt},\,{\it ii},\,{\it qq}\, := \,[0],\,[ 0.0],\,[1]\]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lx := PLOT(`...`)}{\[\displaystyle {\it lx}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\begin{maplelatex}
\mapleinline{inert}{2d}{lv := PLOT(`...`)}{\[\displaystyle {\it lv}\, := \,{\it PLOT} \left( \mbox {{\tt `...`}} \right) \]}
\end{maplelatex}
\mapleresult
\mapleplot{Euler_ball_dropplot2d6.eps}
\end{maplegroup}
\begin{maplegroup}
\begin{mapleinput}
\mapleinline{active}{1d}{}{}
\end{mapleinput}
\end{maplegroup}
\end{document}
